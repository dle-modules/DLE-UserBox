# UserBox

![version](https://img.shields.io/badge/version-1.5.1-red.svg?style=flat-square "Version")
![DLE](https://img.shields.io/badge/DLE-10.x-green.svg?style=flat-square "DLE Version")
[![MIT License](https://img.shields.io/badge/license-MIT-blue.svg?style=flat-square)](https://github.com/dle-modules/DLE-UserBox/blob/master/LICENSE)

Простой модуль для вывода информации о любом пользователе в любом месте сайта на DLE 9.8 - 10.x

Понадобится, если нужно вывести ***не только аватар*** и с минимальной нагрузкой на сайт!
Модуль будет полезен тогда, когда нужно вывести информацию о каком-либо пользователе в произвольном месте сайта (В т.ч. вне шаблона полной новости).
Например кулинарным сайтам, где нужно вывести информацию об авторе рецепта непосредственно в рецепт или личным (коллективным) блогам. 

## Возможности

- Подключение одной строкой.
- Вывод данных из профиля пользователя в любом месте сайта, на основе логина пользователя или текущего пользователя.
- Вывод дополнительных полей профиля пользователя (выводятся только те, которые не являются личными).
- Возможность использовать собственные шаблоны для вывода информации.
- Настраиваемая заглушка-аватар на случай, если у пользователя нет аватара и нужно вывести не стандартную заглушку.
- Кеширование результата работы модуля. Кеш создаётся с учётом логина пользователя, дефолтного аватара и используемого шаблона вывода модуля.

## Особенности

- **Одна обязательная переменная в строке подключения** - &userName. Именно через эту переменную модуль определяет для какого юзера выводить информацию.
- **Добавляет один запрос на каждого выводимого модулем пользователя**. Т.е. если выводить информацию об авторе новости в кратких новостях и на главной странице сайта выводится 30 новостей, которые опубликовали 10 пользователей (по три новости каждый) - то модуль при первом обращении к странице добавит 10 запросов в БД, после чего данные будут браться уже из кеша (при включенном кешировании на сайте). Если на второй странице попадётся пользователь с первой страницы, то запрос в БД на этого пользователя делаться не будет. 
- **Собственные теги для вывода в шаблоне.** Отдельные теги сделаны для того, что бы не было конфликтов и для упрощения обработки этих тегов в модуле, что сократило код процентов на 10-15 точно.
- **Собственная папка с шаблонами**. Так же для удобства использования.
- **Выводятся не все данные.** Т.к. выводить все данные о пользователе не имеет смысла, а так же в целях экономии ресурсов сервера выводятся следующие данные:
- Email пользователя
- Логин
- Кол-во новостей
- ID пользователя
- Кол-во комментариев
- Группа (форматированный вывод с префиксами и суффиксами)
- Дата последнего посещения сайта
- Дата регистрации
- Информация о пользователе
- URL аватарки (или настраиваемая заглушка)
- Полное имя
- Место проживания
- Номер ICQ
- Дополнительные поля (выводятся только те, которые не являются личными)

Полный список поддерживаемых модулем тегов приведён в шаблоне **userbox/dafault.tpl**


## Установка

- Распаковать архив в корень сайта, при этом не забывайте переименовать папку THEME в соответствии с названием текущего шаблона сайта.
- В нужном месте любого шаблона сайта прописать: `{include file="engine/modules/userbox.php?&userName=login"}` где login - логин пользователя.
- Всё!

Примеры использования:
`{include file="engine/modules/userbox.php?&userName={login}"}` выведет информацию о авторе, если эту строку прописать в шаблоне новости (краткой или полной) или комментария (к примеру можно вывести рейтинг пользователя).

`{include file="engine/modules/userbox.php?&userName=this"}` выведет информацию о текущем пользователе, эту конструкию можно использовать для вывода инвормации о текущем пользователе вне шаблона login.tpl.

`{include file="engine/modules/userbox.php?&userName=thisNewsId"}` выведет информацию об авторе новости при просмотре полной новости (при этом добавится один запрос). Подобная конструкция нужна на случай вывода вне шаблона полной новости. При выводе в шаблоне полной новости используйте `&userName={login}`

`{include file="engine/modules/userbox.php?&userName=Бот&template=newtemplate&defAvatar=images/picture.jpg"}` Выведет информацию о пользователе с логином **Бот**, для вывода будет использован шаблон, лежащий в папке **userbox/newtemplate.tpl**, при этом если у пользователя нет аватарки (или не задан gravatar в настройках) - будет выведено изображение из папки **images/picture.jpg**.

## Переменные строки подключения
- `&userName=user` - Ия пользователя  (Если указать &userName=this - будет выведена информация о текущем пользователе.)
- `&defAvatar=images/image.jpg` - дефолтная заглушка аватара.
- `&template=mytemplate` - шаблон вывода.
